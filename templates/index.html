<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Picture Generator</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=3">
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <svg width="26" height="26" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3l2.39 4.84 5.34.78-3.86 3.76.91 5.32L12 15.9l-4.78 2.5.91-5.32L4.27 8.62l5.34-.78L12 3z" fill="currentColor"/></svg>
      <span>Picture Generator</span>
    </div>
    <button id="theme-toggle" class="icon-btn" title="Theme wechseln" aria-label="Theme wechseln">
      <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="currentColor"/></svg>
    </button>
  </header>

  <main class="container">
    <section class="card">
      <h1 class="card-title">Bild generieren</h1>

      <div class="segmented" role="tablist" aria-label="Generation Type">
        <input type="radio" name="genType" id="opt-txt2img" value="txt2img" checked />
        <label for="opt-txt2img" role="tab" aria-controls="panel-txt2img">Text→Bild</label>
        <input type="radio" name="genType" id="opt-img2img" value="img2img" />
        <label for="opt-img2img" role="tab" aria-controls="panel-img2img">Bild→Bild</label>
      </div>

      <div id="error-banner" class="alert alert-error" role="alert" hidden></div>

      <form id="generate-form" novalidate>
        <div class="grid">
          <div class="form-group">
            <label for="prompt">Prompt</label>
            <textarea id="prompt" name="prompt" placeholder="Was soll generiert werden?" rows="3" required></textarea>
          </div>

          <div class="form-group">
            <label for="negative-prompt">Negative Prompt <span class="muted">(optional)</span></label>
            <input id="negative-prompt" name="negative-prompt" type="text" placeholder="Was vermeiden?" />
          </div>
        </div>

        <div id="img2img-wrap" class="form-group" hidden>
  <label>Quellbild (für Bild→Bild)</label>

  <div id="dropzone" class="dropzone" tabindex="0"
       aria-label="Bild hierher ziehen oder klicken, um Datei auszuwählen">
    <input id="image" name="image" type="file" accept="image/*" hidden />
    <button type="button" id="clear-image" class="clear-btn" title="Bild entfernen" aria-label="Bild entfernen">
      <!-- kleines X-Icon -->
      <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M18.3 5.71L12 12l6.3 6.29-1.41 1.41L10.59 13.41 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.3 10.59 10.59 16.89 4.3z" fill="currentColor"/>
      </svg>
    </button>

    <div class="dropzone-inner">
      <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M19 13v6H5v-6H3v8h18v-8h-2zM11 7.83L8.41 10.41 7 9l5-5 5 5-1.41 1.41L13 7.83V16h-2V7.83z" fill="currentColor"/>
      </svg>
      <span>Bild ablegen oder klicken</span>
    </div>

    <img id="preview" class="preview" alt="Vorschau" hidden />
  </div>
</div>
        <div class="grid">
          <div class="form-group">
            <label for="model">Style / Checkpoint</label>
            <select id="model" name="model">
              {% for style in styles %}
                <option value="{{ style }}">{{ style }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
            <label for="sampler">Sampler</label>
            <select id="sampler" name="sampler">
              {% for sampler in samplers %}
                <option value="{{ sampler }}">{{ sampler }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
            <label for="width">Breite (px)</label>
            <input id="width" name="width" type="number" inputmode="numeric" min="64" max="2048" step="64" value="512" required />
            <small class="muted">Vielfaches von 64</small>
          </div>

          <div class="form-group">
            <label for="height">Höhe (px)</label>
            <input id="height" name="height" type="number" inputmode="numeric" min="64" max="2048" step="64" value="512" required />
            <small class="muted">Vielfaches von 64</small>
          </div>

          <div class="form-group">
            <label for="steps">Steps: <span id="steps-val">30</span></label>
            <input id="steps" name="steps" type="range" min="1" max="150" value="30" />
          </div>
        </div>

        <button id="submit-btn" class="btn primary" type="submit">
          <span class="btn-label">Bild generieren</span>
          <span class="spinner" aria-hidden="true"></span>
        </button>
      </form>
    </section>

    <section id="result-card" class="card" hidden>
      <div class="result-header">
        <h2 class="card-title">Ergebnis</h2>
        <div class="result-actions">
          <a id="download-link" class="btn subtle" href="#" download>Download</a>
        </div>
      </div>
      <div class="result-body">
        <img id="generated-image" class="generated-image" alt="Generiertes Bild" />
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <small>Hinweis: Die App erwartet eine laufende Stable-Diffusion API unter <code>SD_API_URL</code>.</small>
  </footer>

<script src="{{ url_for('static', filename='app.js') }}" defer></script>

</body>
</html>
